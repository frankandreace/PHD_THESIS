
\chapter{Perspectives and future work}
\label{sec:perspectives}
In this section, I will present several considerations and perspectives derived from the research proposed in this manuscript, from extended discussions with colleagues, supervisors, and other experts in the field over my PhD.

\section{On human pangenomics: graphs and beyond}
The analysis presented in chapter~\ref{pap:first} provides a basis for understanding the features, limitations, and utility of current software designed for constructing pangenome graphs. These tools use state-of-the-art computational algorithms to be able to produce graphs from large and complex genomes with reasonable amount of computational resources. During the time-frame of my PhD, some tools have been improved and other proposed. As we get closer to a potential paradigm shift from linear reference sequences to pangenomes as reference for analysis, certain aspects of computational pangenomics could be prioritized. 


\textbf{Reproducibility and Computational Stability}\\
In the case of leading general-purpose pangenome reference construction tools, such as \pggb and \mcactus, which produce variation graphs, it is important that the graph generated from a set of sequences remain consistent when identical input is provided. Inconsistencies in graph production can hinder reproducibility of analysis based on the same set of input sequences. In contrast, we have confirmed that \dbgs do not suffer from this problem as their construction is mathematically deterministic. To partially address and quantify this issue, it would be useful to develop a tool that gets two variation graph as input, generated from a permutation of the same sample of genomes, and outputs the regions of the genomes where the two structures do not coincide. This would be also useful to verify the improvement of subsequent versions of the tools.


\textbf{Biological Correctness of Pangenome Graphs}\\
As variation graphs rely on sequence alignment to infer the graph structure, difficult-to-map regions and complex loci can lead to confounded graph sections that may not accurately represent the genetic variation in the locus. Highly complex centromeric regions exemplify such areas: in this moment, \mcactus omits centromeric variation, \pggb includes it, at the cost increased graph complexity. \\
Conversely, De Bruijn Graphs are challenging to interpret already at small scale. Extracting a large region from a graph is non-trivial, as distinguishing between sequences belonging to the region and those contiguous to common repetitions is difficult.
A valuable future development would be the design of a method to help comprehensively evaluate the computational and biological quality of the pangenomic data structures produced. For variation graphs it could be done by using a curated datasets of known repetitive regions of the genome and verifying the structure of the sub-graphs of that regions by visualization and detection of loops in paths. For \dbgs, as I also tried during my PhD, it would be very useful to produce a \dbg-based data structure that can be visualized in a quasi-linear way like variation graphs. A possible implementation would require recording paths in the graph by or pseudo-mapping the input genomes to the \ccdbg structure or a novel method to construct a \cdbg that directly stores the paths when building the graph. I have tested the first approach using \ggcat and \ssh on human genomes and it is very computationally expensive compared to \ccdbg construction, especially in terms of time. Another implementation could record information only for unitigs, i.e., nodes in the graph, that correspond to repetitions in the genome that confound the graph structure. This would help disentangle the graph.
%Variation graph construction tools would benefit of a quality check of the generated graph in complex regions while \dbg would require a validation of the correctness of an extracted region.


\textbf{Standardization of \dbg Colors}\\
Proposing a common file format or interface to access colors for color \dbg based methods would promote the development of new application-specific tools based on \kmers. The current diverse landscape of colored \kmer sets construction tools limits future development to a specific tool. Variation graphs use paths or walks as standard ways to represent haplotype information in the graph. Producing a common interface to query colors in \dbgs would serve a similar purpose. To achieve this goal, it would be useful to have a conference of \kmer researchers to agree together to a common interface for color and metadata based tools, starting from examples like the \kmer file format~\cite{kff} and the \kmer days conference at EBI.


\textbf{Alternative \kmer Based Pangenome Representations}\\
While graphs are the most used representation, other \kmer based methods and data structures can provide a more suitable model for specific use-cases. Unitig (and \kmer) matrices, as produced by  \kmt~\cite{kmtricks} and \muset, offer valid alternatives to comprehensively represent diversity in populations. Proposing new data structures equivalent to \ccdbgs and interfaces to transition between them allows users to choose the best representation for their specific application. While \muset is a first attempt at producing a unitig matrix representation,it is quite inefficient as it uses multiple tools that are not designed to be used for this scope and passes by various text representations that make it less efficient. In the future it would be useful to implement a direct construction methods that stores a binary representation on disk, loads it in memory for queries and can output a plain text matrix for other downstream applications. 


\section{Exploring \kmer data structures}


\textbf{\kmer Based Downstream Applications}\\
While significant advancements are being made in \kmer based methods to efficiently represent samples of varying complexity, further research is required to bridge the gap between these efficient representation methods and more comprehensive tool-sets for downstream analysis.
Notable efforts in this direction provide nucleotide search capabilities for huge collections of data. The Ocean Read Atlas (ORA)~\cite{ora}, uses \kmt to provide real-time queries of 1,393 marine seawater metagenome samples obtained from the Tara Oceans project. Logan~\cite{logan} and Metagraph~\cite{metagraph}, that use \kmer based methods to represent the entire World genetic diversity, as a snapshot of the ENA or SRA archives. All three projects offer online queries of their data with very useful visualization capabilities.\\
However, tools that address areas traditionally dominated by alignment-based methods, particularly in genomic analysis, are slowly emerging at scale. \muset represents a proposal for an alternative platform for genetic variation studies, aims to partially address this gap and offers unbiased genome analysis, potentially enabling discoveries in regions that are not considered in traditional GWAS.\\ One very useful direction would be to enrich pangenome graphs with other metadata that is not only the sample of origin but also annotations of region of the genome as protein-coding genes, functional elements, chromatin accessibility. This information could in theory be injected in the graph by reproducing the sequences spanned by these regions and adding them to the graph. When a sequence is color-queried, this information would be returned. The drawback is the staggering amount of colors (one associated to each annotation) that would render the color data structure much larger and possibly impractical. Providing a more efficient representation for annotation would render these data structures more useful for other genomic analyses.


\textbf{Improving methods for metadata}\\
The two prototype \kmer based methods proposed in this manuscript offer an example of the great research potential for improving \kmer based methods for specific applications, particularly in handling metadata such as colors and counts.
As pangenomics continues to evolve and the importance to discern between samples becomes crucial, the proposed data structures, together with other models, could be improved to allow \emph{colored} queries or complex metadata queries. For instance, they could be used to return the abundance of a \kmer or sequence in a specific sample. While this type of information is stored in a text matrix produced by \muset, it would be beneficial to index it to enable fast and programmatic queries. As proposed in the previous point, I think expanding metadata capabilities of \kmer based methods to store diverse kind of metadata, like annotations, could be of great use to provide not only information about frequency of a particular sequence in the input genomes but also abut its function.